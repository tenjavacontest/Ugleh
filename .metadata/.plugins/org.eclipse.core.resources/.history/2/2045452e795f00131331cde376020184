package com.tenjava.ugleh.sitstick;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.bukkit.entity.Entity;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.entity.EntityDamageByEntityEvent;

public class SSListener implements Listener {
	public Map<String, List<Integer>> sitStickList = new HashMap<String, List<Integer>>(); //List for storing the entities selected per player.
	@EventHandler
	public void SitStickUsedEvent(EntityDamageByEntityEvent event){
		Entity e = event.getDamager();
		if(e instanceof Player){ //Player hitting an entity.
			Player p = (Player)e;
			if((p.getItemInHand() != null) && p.getItemInHand().equals(Main.sitStickItem)){//NPE check, and then checks if stick in hand.
				event.setCancelled(true); //SitStick doesn't cause damage.
				addToSitStickList(p, event.getEntity()); //Damager, Selection
			}
		}
	}
/*
 * addToSitStickList
 * Player p
 * The player who is selecting an entity to use.
 * Entity selection
 * The Selection thats going to be used.
*/	private void addToSitStickList(Player p, Entity selection) {
	String playerName = p.getName();
	Integer selectionID = selection.getEntityId();
	List<Integer> tempPlayerSelections = new ArrayList<Integer>();
	if(sitStickList.containsKey(playerName)){//Player already has a selection made.
		tempPlayerSelections = sitStickList.get(playerName);
	}else{//Create new sitStickList for playerName
		tempPlayerSelections = new ArrayList<Integer>();
	}
	tempPlayerSelections.add(selectionID);
	sitStickList.put(playerName, tempPlayerSelections); //Adding new selection to the overall list.

	}
	
	
}
